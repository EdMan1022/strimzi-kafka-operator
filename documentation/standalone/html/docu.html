<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.6.1">
<meta name="author" content="Version 0.1">
<title>Apache Kafka Installation and Configuration Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
*:not(pre)>code.nobreak{word-wrap:normal}
*:not(pre)>code.nowrap{white-space:nowrap}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:initial}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px 0}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:.4em .75em 0 .75em;line-height:1;vertical-align:top}
.colist>table tr>td:first-of-type img{max-width:initial}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Apache Kafka Installation and Configuration Guide</h1>
<div class="details">
<span id="author" class="author">Version 0.1</span><br>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This guide describes how to install and configure Apache Zookeeper and Apache Kafka
as non-containerized workloads on bare-metal or virtual machines.</p>
</div>
</div>
<div id="toc" class="toc">
<div id="toctitle">My Content</div>
<ul class="sectlevel1">
<li><a href="#_overview">1. Overview</a></li>
<li><a href="#_apache_zookeeper">2. Apache Zookeeper</a>
<ul class="sectlevel2">
<li><a href="#_installation_on_linux">2.1. Installation on Linux</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites">2.1.1. Prerequisites</a></li>
<li><a href="#_installation_procedure">2.1.2. Installation procedure</a></li>
</ul>
</li>
<li><a href="#_standalone_configuration">2.2. Standalone configuration</a></li>
<li><a href="#_replicated_configuration">2.3. Replicated configuration</a>
<ul class="sectlevel3">
<li><a href="#_procedure">2.3.1. Procedure</a></li>
</ul>
</li>
<li><a href="#_additional_configuration_options">2.4. Additional configuration options</a></li>
<li><a href="#_logging">2.5. Logging</a></li>
<li><a href="#_security">2.6. Security</a>
<ul class="sectlevel3">
<li><a href="#_sasl_authentication">2.6.1. SASL Authentication</a></li>
<li><a href="#_acl_authorization">2.6.2. ACL Authorization</a></li>
<li><a href="#_tls">2.6.3. TLS</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_apache_kafka_broker">3. Apache Kafka broker</a>
<ul class="sectlevel2">
<li><a href="#_installation_on_linux_2">3.1. Installation on Linux</a>
<ul class="sectlevel3">
<li><a href="#_prerequisites_2">3.1.1. Prerequisites</a></li>
<li><a href="#_installation_procedure_2">3.1.2. Installation procedure</a></li>
</ul>
</li>
<li><a href="#_configuration">3.2. Configuration</a>
<ul class="sectlevel3">
<li><a href="#_zookeeper">3.2.1. Zookeeper</a></li>
<li><a href="#_listeners">3.2.2. Listeners</a></li>
<li><a href="#_kafka_commit_logs">3.2.3. Kafka Commit Logs</a></li>
<li><a href="#_security_2">3.2.4. Security</a></li>
<li><a href="#_topic_configuration">3.2.5. Topic configuration</a></li>
<li><a href="#_other_configuration_options">3.2.6. Other configuration options</a></li>
<li><a href="#_logging_2">3.2.7. Logging</a></li>
</ul>
</li>
<li><a href="#_running_kafka">3.3. Running Kafka</a></li>
</ul>
</li>
<li><a href="#_apache_kafka_connect">4. Apache Kafka Connect</a></li>
<li><a href="#_apache_kafka_producer_and_consumer_apis">5. Apache Kafka Producer and Consumer APIs</a></li>
<li><a href="#_apache_kafka_streams_apis">6. Apache Kafka Streams APIs</a></li>
<li><a href="#_sample_configuration_files">7. Sample configuration files</a></li>
</ul>
</div>
</div>
<div class="sect1">
<h2 id="_overview">1. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apache Kafka is a platform for streaming data delivery and processing. It consists from 4 main components:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Kafka Broker</dt>
<dd>
<p>Messaging broker responsible for delivering records from producing clients to consuming clients.</p>
</dd>
<dt class="hdlist1">Kafka Connect</dt>
<dd>
<p>A toolkit for streaming data between Kafka brokers and other systems using <em>Connector</em> plugins.</p>
</dd>
<dt class="hdlist1">Kafka Consumer and Producer APIs</dt>
<dd>
<p>Java based APIs for producing and consuming messages to / from Kafka brokers.</p>
</dd>
<dt class="hdlist1">Kafka Streams API</dt>
<dd>
<p>API for writting <em>stream processor</em> applications.</p>
</dd>
</dl>
</div>
<div class="imageblock">
<div class="content">
<img src="./img/overview.jpg" alt="Overview">
</div>
</div>
<div class="paragraph">
<p>Kafka Broker is the central point connecting all these components. The broker itself uses Apache Zookeeper for
storing configuration data and for cluster coordination (electing leaders, etc.). Before installing Apache Kafka, an Apache
Zookeeper cluster has to be ready.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_apache_zookeeper">2. Apache Zookeeper</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apache Kafka uses Apache Zookeeper to store configuration data as well as for cluster coordination (e.g. leader
election). To start and run a Kafka broker, Zookeeper needs to be installed and available.</p>
</div>
<div class="sect2">
<h3 id="_installation_on_linux">2.1. Installation on Linux</h3>
<div class="sect3">
<h4 id="_prerequisites">2.1.1. Prerequisites</h4>
<div class="paragraph">
<p>Zookeeper requires following components to be installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JRE 8</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_installation_procedure">2.1.2. Installation procedure</h4>
<div class="paragraph">
<p>Zookeeper can be installed using following installation procedure:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add new <code>zookeeper</code> user and group:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo groupadd zookeeper
sudo useradd -g zookeeper zookeeper
sudo passwd zookeeper</code></pre>
</div>
</div>
</li>
<li>
<p>Create directory <code>/opt/zookeeper</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo mkdir /opt/zookeeper</code></pre>
</div>
</div>
</li>
<li>
<p>Download the latest stable version from Apache Zookeeper <a href="http://zookeeper.apache.org/releases.html">download website</a></p>
</li>
<li>
<p>Unpack the archive into <code>/opt/zookeeper</code> directory (replace <code>x.x.x</code> for the downloaded version of Zookeeper - e.g. <code>3.4.11</code>)</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo tar xvfz zookeeper-x.x.x.tar.gz -C /opt/zookeeper --strip-components=1</code></pre>
</div>
</div>
</li>
<li>
<p>Change the ownership of the <code>/opt/zookeeper</code> directory to the <code>zookeeper</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo chown -R zookeeper:zookeeper /opt/zookeeper</code></pre>
</div>
</div>
</li>
<li>
<p>Create directory <code>/var/lib/zookeeper</code> for storing Zookeeper data and set its ownership to the <code>zookeeper</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo mkdir /var/lib/zookeeper
sudo chown -R zookeeper:zookeeper /var/lib/zookeeper</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_standalone_configuration">2.2. Standalone configuration</h3>
<div class="paragraph">
<p>Zookeeper can run in a standalone mode with only a single instance. However, since Kafka broker is fully dependent on
Zookeeper, using a standalone configuration creates a single point of failure. Therefore the standalone configuration
is not recommended for any production use cases.</p>
</div>
<div class="paragraph">
<p>Zookeeper uses a properties file for configuration. The most important configuration options are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>tickTime</code></dt>
<dd>
<p>Zookeeper&#8217;s basic time unit (in milliseconds) used for heartbeats and session timeouts (for example, minimum
session timeout will be two ticks).</p>
</dd>
<dt class="hdlist1"><code>dataDir</code></dt>
<dd>
<p>The directory where Zookeeper stores its transaction log and snapshots of its in-memory database. This should be
set to the <code>/var/lib/zookeeper/</code> directory created during installation.</p>
</dd>
<dt class="hdlist1"><code>clientPort</code></dt>
<dd>
<p>Port number where clients can connect. Defaults to <code>2181</code>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The sample configuration file can be found in <code>conf/zoo_sample.cfg</code> in the Zookeeper installation directory.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Consider putting the <code>dataDir</code> directory on separate disk device to minimize the latency in Zookeeper.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Zookeeper configuration file should be located in <code>/opt/zookeeper/conf/zoo.cfg</code>. A basic example of the configuration
file can be found below. The configuration file should be readable by the <code>zookeeper</code> user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>timeTick=2000
dataDir=/var/lib/zookeeper/
clientPort=2181</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the configuration file is prepared, Zookeeper can be started using following command. In case the configuration
file is not located in <code>/opt/zookeeper/conf/zoo.cfg</code> the command has to be adapted accordingly.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - zookeeper
/opt/zookeeper/bin/zkServer.sh start conf/zoo.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>start</code> command will start the Zookeeper server in the background. To run Zookeeper attached to the terminal,
<code>start</code> can be replaced with <code>start-foreground</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - zookeeper
/opt/zookeeper/bin/zkServer.sh start-foreground conf/zoo.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>To stop running Zookeeper instance following command can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - zookeeper
/opt/zookeeper/bin/zkServer.sh stop conf/zoo.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>To restart running Zookeeper instance following command can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - zookeeper
/opt/zookeeper/bin/zkServer.sh restart conf/zoo.cfg</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_replicated_configuration">2.3. Replicated configuration</h3>
<div class="paragraph">
<p>For production use cases it is strongly recommended to run a cluster of replicated Zookeeper instances.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Zookeeper clusters are sometimes also refer to as <em>ensembles</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Zookeeper clusters usually consist of an odd number of nodes. Zookeeper requires a majority of cluster nodes to be available
in order to work. For example, a cluster with 3 nodes requires at least 2 of them to be up and running. In other words, it can
tolerate 1 node being down. A cluster consisting of 5 nodes requires at least 3 nodes to be available. In other words, it
can tolerate 2 nodes being down.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Zookeeper can run in clusters with an even number of nodes. The additional node, however, doesn&#8217;t increase the
resiliency of the cluster. A cluster with 4 nodes requires at least 3 nodes to be available and can tolerate only 1 node
being down. Therefore it has exactly the same resiliency as a cluster with only 3 nodes.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The different Zookeeper nodes should be ideally placed into different data centers or network segments. Increasing the
number of Zookeeper nodes increases the workload spent on cluster synchronization. For most Kafka use cases Zookeeper
cluster with 3, 5 or 7 nodes should be fully sufficient.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Zookeeper cluster with 3 nodes can tolerate only 1 unavailable node. This means that when a cluster node
crashes while you are doing maintenance on another node your Zookeeper cluster will be unavailable.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Replicated Zookeeper configuration supports all configuration options supported by the standalone configuration.
Additional options are added for the cluster configuration:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>initLimit</code></dt>
<dd>
<p>Amount of time to allow followers to connect and sync to the cluster leader. The time is specified as
a number of ticks (see the <code>timeTick</code> potion for more details).</p>
</dd>
<dt class="hdlist1"><code>syncLimit</code></dt>
<dd>
<p>Amount of time for which followers can be behind the leader. The time is specified as a number of ticks
(see the <code>timeTick</code> potion for more details).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>In addition to the options above, every configuration file should contain a list of servers which should be members of
the Zookeeper cluster. The server records should be specified in the format <code>server.id=hostname:port1:port2</code>, where:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>id</code></dt>
<dd>
<p>is the ID of the Zookeeper cluster node.</p>
</dd>
<dt class="hdlist1"><code>hostname</code></dt>
<dd>
<p>is the hostname or IP address where the node listens for connections.</p>
</dd>
<dt class="hdlist1"><code>port1</code></dt>
<dd>
<p>is the number of the port used for intra-cluster communication.</p>
</dd>
<dt class="hdlist1"><code>port2</code></dt>
<dd>
<p>is the number of the port used for leader election.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The following example shows what the configuration file for a Zookeeper cluster might look like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>timeTick=2000
dataDir=/var/lib/zookeeper/
clientPort=2181
initLimit=5
syncLimit=2

server.1=172.17.0.1:2888:3888
server.2=172.17.0.2:2888:3888
server.3=172.17.0.3:2888:3888</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each node in the Zookeeper cluster has to be assigned an <code>ID</code>. The <code>ID</code> has to be unique within the Zookeeper
cluster. Each node&#8217;s <code>ID</code> is configured in a file named <code>myid</code> which has
to be stored in the <code>dataDir</code> folder (e.g. <code>/var/lib/zookeeper/</code>). The <code>myid</code> files should contain only a single line
with the <code>ID</code> written as text. The <code>ID</code> can be any integer from 1 to 255. This file has to be created manually on each
cluster node. Using this file, each Zookeeper instance will use the configuration from the corresponding <code>server.</code> line in the
configuration file to configure its listeners and use all other <code>server.</code> lines to identify other cluster members.</p>
</div>
<div class="paragraph">
<p>Once the configuration files are prepared, the individual cluster nodes should be started in the same way as a standalone
Zookeeper instance.</p>
</div>
<div class="sect3">
<h4 id="_procedure">2.3.1. Procedure</h4>
<div class="paragraph">
<p>Follow this procedure <strong>on each node</strong> to start a replicated Zookeeper cluster:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create the <code>myid</code> file as described above.</p>
</li>
<li>
<p>Create the configuration file with list of all cluster members as described above. This file should be identical on
all nodes.</p>
</li>
<li>
<p>Start the instance using:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - zookeeper
/opt/zookeeper/bin/zkServer.sh start conf/zoo.cfg</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_additional_configuration_options">2.4. Additional configuration options</h3>
<div class="paragraph">
<p>Setting the following options should be considered, depending on the exact use case:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>maxClientCnxns</code></dt>
<dd>
<p>Miximum number of simultaneously connected clients.</p>
</dd>
<dt class="hdlist1"><code>autopurge.snapRetainCount</code></dt>
<dd>
<p>Number of snapshots of Zookeeper&#8217;s in-memory database which will be retained. Default value is <code>3</code>.</p>
</dd>
<dt class="hdlist1"><code>autopurge.purgeInterval</code></dt>
<dd>
<p>Interval, in hours, for purging snapshots. Default value is <code>0</code> (auto-purging disabled).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>All available configuration options can be found in Apache Zookeeper
<a href="http://zookeeper.apache.org/doc/current/zookeeperAdmin.html#sc_maintenance">documentation</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_logging">2.5. Logging</h3>
<div class="paragraph">
<p>Zookeeper is using <em>log4j</em> as its logging infrastructure. Logging configuration is by default read from the
<code>log4j.propeties</code> configuration file which should be placed either in the <code>/opt/zookeeper/conf/</code> directory or
in the classpath. The location and name of the configuration file can be changed using the Java property
<code>log4j.configuration</code> which can be passed to Zookeeper using the <code>SERVER_JVMFLAGS</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - zookeeper
export SERVER_JVMFLAGS="-Dlog4j.configuration=file:/my/path/to/log4j.config"; /opt/zookeeper/bin/zkServer.sh start conf/zoo.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>More information about <em>log4j</em> configuration can be found in the
<a href="http://logging.apache.org/log4j/1.2/manual.html"><em>log4j</em> manual</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_security">2.6. Security</h3>
<div class="sect3">
<h4 id="_sasl_authentication">2.6.1. SASL Authentication</h4>
<div class="paragraph">
<p>By default, Zookeeper doesn&#8217;t use any form of authentication and allows anonymous connections. However it supports Java
Authentication and Authorization Service (JAAS) which can be used to set up authentication using Simple Authentication
and Security Layer (SASL). Zookeeper supports authentication using the DIGEST-MD5 SASL mechanism with locally stored
credentials, or authentication using Kerberos.</p>
</div>
<div class="paragraph">
<p>JAAS is configured using a separate configuration file. It is recommended to place the JAAS configuration file in the
same directory as the Zookeeper configuration (<code>/opt/zookeeper/conf/</code>). The recommended file name is <code>jaas.conf</code>. When
using Zookeeper cluster, the JAAS configuration file has to be created on all cluster nodes.</p>
</div>
<div class="paragraph">
<p>SASL Authentication is configured separately for server-to-server communication (communication between Zookeeper
instances) and client-to-server communication (e.g. communication between Kafka and Zookeeper). Server-to-server
authentication is relevant only for resilient Zookeeper clusters with multiple nodes.</p>
</div>
<div class="sect4">
<h5 id="_server_to_server_authentication">Server-to-Server authentication</h5>
<div class="paragraph">
<p>For server-to-server authentication, the JAAS configuration file contains both parts: the server configuration as well as the
client configuration. Each part of the configuration has its own <em>context</em>. The context is configuration that has the following
format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ContextName {
       param1
       param2;
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using DIGEST-MD5 SASL mechanism the <code>QuorumServer</code> context needs to contain all the usernames and passwords in
unencrypted form which will be allowed to connect. A second context, <code>QuorumLearner</code>, has to be configured to configure the
client which is built into Zookeeper. It again contains the password in unencrypted form. An example of the JAAS
configuration file for DIGEST-MD5 mechanism can be found below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>QuorumServer {
       org.apache.zookeeper.server.auth.DigestLoginModule required
       user_zookeeper="123456";
};

QuorumLearner {
       org.apache.zookeeper.server.auth.DigestLoginModule required
       username="zookeeper"
       password="123456";
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, Kerberos-based authentication can be configured. A detailed guide for configuring Kerberos
authentication is beyond the scope of this document. More details about Kerberos configuration can be found in the
<a href="https://docs.oracle.com/javase/7/docs/jre/api/security/jaas/spec/com/sun/security/auth/module/Krb5LoginModule.html">JAAS documentation</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>QuorumServer {
       com.sun.security.auth.module.Krb5LoginModule required
       useKeyTab=true
       keyTab="/path/to/keytab"
       storeKey=true
       useTicketCache=false
       debug=false
       principal="zkquorum/fully.qualified.domain.name@EXAMPLE.COM";
};

QuorumLearner {
       com.sun.security.auth.module.Krb5LoginModule required
       useKeyTab=true
       keyTab="/path/to/keytab"
       storeKey=true
       useTicketCache=false
       debug=false
       principal="learner/fully.qualified.domain.name@EXAMPLE.COM";
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to the JAAS configuration file, the server-to-server authentication also needs to be enabled in the regular
Zookeeper configuration file. To enable it add following options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>quorum.auth.enableSasl=true
quorum.auth.learnerRequireSasl=true
quorum.auth.serverRequireSasl=true
quorum.auth.learner.loginContext=QuorumLearner
quorum.auth.server.loginContext=QuorumServer
quorum.cnxn.threads.size=20</code></pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, if Kerberos authentication is used, the <em>Kerberos service principal</em> has to be specified:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>quorum.auth.kerberos.servicePrincipal=servicename/_HOST</code></pre>
</div>
</div>
<div class="paragraph">
<p>The JAAS configuration file has to be passed to the Zookeeper server as a Java property.
The <code>SERVER_JVMFLAGS</code> environment variable can be used for that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - zookeeper
export SERVER_JVMFLAGS="-Djava.security.auth.login.config=/opt/zookeeper/conf/jaas.conf"; /opt/zookeeper/bin/zkServer.sh start conf/zoo.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>More details about server-to-server authentication can be found on the Zookeeper
<a href="https://cwiki.apache.org/confluence/display/ZOOKEEPER/Server-Server+mutual+authentication">wiki</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_client_to_server_authentication">Client-to-Server authentication</h5>
<div class="paragraph">
<p>Client-to-server authentication is configured in the same JAAS file as the server-to-server authentication. However,
unlike the server-to-server authentication, it contains only the server part. The client part of the configuration has
to be done in the client. How to configure a Kafka broker to connect to Zookeeper using authentication is described in the
Kafka installation part of this guide.</p>
</div>
<div class="paragraph">
<p>Another context has to be added to the JAAS configuration file to configure client-to-server authentication. This
context has to be named <code>Server</code>. For DIGEST-MD5 mechanism it configures all usernames and passwords:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Server {
    org.apache.zookeeper.server.auth.DigestLoginModule required
    user_super="123456"
    user_kafka="123456";
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to enable authentication using Kerberos. More details about Kerberos configuration can be found in the
<a href="https://docs.oracle.com/javase/7/docs/jre/api/security/jaas/spec/com/sun/security/auth/module/Krb5LoginModule.html">JAAS documentation</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Server {
       com.sun.security.auth.module.Krb5LoginModule required
       useKeyTab=true
       keyTab="/path/to/server/keytab"
       storeKey=true
       useTicketCache=false
       principal="zookeeper/yourzkhostname";
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>After configuring the JAAS context, client-to-server authentication needs to be enabled in the Zookeeper configuration
file. To enable it following lines should be added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>requireClientAuthScheme=sasl
authProvider.1=org.apache.zookeeper.server.auth.SASLAuthenticationProvider
authProvider.2=org.apache.zookeeper.server.auth.SASLAuthenticationProvider
authProvider.3=org.apache.zookeeper.server.auth.SASLAuthenticationProvider</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>authProvider.ID</code> property has to be added for every server which is part of the Zookeeper cluster.</p>
</div>
<div class="paragraph">
<p>The JAAS configuration file has to be passed to the Zookeeper server as a Java property.
The <code>SERVER_JVMFLAGS</code> environment variable can be used for that:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - zookeeper
export SERVER_JVMFLAGS="-Djava.security.auth.login.config=/opt/zookeeper/conf/jaas.conf"; /opt/zookeeper/bin/zkServer.sh start conf/zoo.cfg</code></pre>
</div>
</div>
<div class="paragraph">
<p>More details about client to server authentication can be found on the Zookeeper
<a href="https://cwiki.apache.org/confluence/display/ZOOKEEPER/Client-Server+mutual+authentication">wiki</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_acl_authorization">2.6.2. ACL Authorization</h4>
<div class="paragraph">
<p>Zookeeper supports access control lists (ACLs) to protect data stored inside it. Apache Kafka can automatically configure the ACL rights
for all Zookeeper records it creates so no other ZooKeeper user can modify them. For more details see the Kafka installation
part of this guide</p>
</div>
</div>
<div class="sect3">
<h4 id="_tls">2.6.3. TLS</h4>
<div class="paragraph">
<p>The latest version of Zookeeper currently doesn&#8217;t support TLS for encryption or authentication.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_apache_kafka_broker">3. Apache Kafka broker</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An Apache Kafka broker is responsible for delivering records from producing clients to consuming clients. A Kafka broker can
run as a single instance, but usually the brokers run in a cluster consisting of multiple brokers. The cluster is
scalable. Depending on availability requirements and expected data volumes, the cluster can consist of any number of nodes, from a single digit up to hundreds or thousands of nodes. When required, additional nodes can be added to the cluster or
removed from it.</p>
</div>
<div class="sect2">
<h3 id="_installation_on_linux_2">3.1. Installation on Linux</h3>
<div class="sect3">
<h4 id="_prerequisites_2">3.1.1. Prerequisites</h4>
<div class="paragraph">
<p>Apache Kafka requires the following components to be installed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JRE 8</p>
</li>
<li>
<p>Apache Zookeeper</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_installation_procedure_2">3.1.2. Installation procedure</h4>
<div class="paragraph">
<p>Kafka can be installed using following installation procedure:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add new <code>kafka</code> user and group:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo groupadd kafka
sudo useradd -g kafka kafka
sudo passwd kafka</code></pre>
</div>
</div>
</li>
<li>
<p>Create directory <code>/opt/kafka</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo mkdir /opt/kafka</code></pre>
</div>
</div>
</li>
<li>
<p>Download the latest stable version from Apache Kafka <a href="http://kafka.apache.org/downloads">download website</a></p>
</li>
<li>
<p>Unpack the archive into <code>/opt/kafka</code> directory (replace <code>y.y</code> with the version of Scala and <code>x.x.x</code> for the downloaded
version of Kafka - e.g. <code>2.12</code> and <code>1.0.0</code>)</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo tar xvfz kafka_y.y-x.x.x.tar.gz -C /opt/kafka --strip-components=1</code></pre>
</div>
</div>
</li>
<li>
<p>Change the ownership of the <code>/opt/kafka</code> directory to the <code>kafka</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo chown -R kafka:kafka /opt/kafka</code></pre>
</div>
</div>
</li>
<li>
<p>Create directory <code>/var/lib/kafka</code> for storing Kafka data and set its ownership to the <code>kafka</code> user:</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sudo mkdir /var/lib/kafka
sudo chown -R kafka:kafka /var/lib/kafka</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration">3.2. Configuration</h3>
<div class="paragraph">
<p>Kafka uses a properties file to store static configuration. The recommended location for the configuration file is
<code>/opt/kafka/config/kafka.properties</code>. The configuration file should be readable by the <code>kafka</code> user.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A sample configuration file can be found in <code>config/server.properties</code> in Kafka installation directory.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Each broker needs to be assigned a unique broker id. The broker id has to be an integer greater than or equal to 0. The
broker id is used to identify the brokers after restarts or crashes and it is therefore important that the id is stable
and doesn&#8217;t change over time. The broker id is configured in the broker properties file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>broker.id=1</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_zookeeper">3.2.1. Zookeeper</h4>
<div class="paragraph">
<p>Kafka brokers need Zookeeper to store some parts of their configuration as well as to coordinate the cluster (for
example to decide which node is a leader for which partition). Connection details for the Zookeeper cluster are stored
in the configuration file. The field <code>zookeeper.connect</code> contains a comma-separated list of hostnames and ports of members
of the zookeeper cluster. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>zookeeper.connect=zoo1.my-domain.com:2181,zoo2.my-domain.com:2181,zoo3.my-domain.com:2181</code></pre>
</div>
</div>
<div class="paragraph">
<p>Kafka will use these addresses to connect to the Zookeeper cluster. With this configuration, all Kafka znodes will be
created directly in the root of Zookeeper database. Therefore, such a Zookeeper cluster could be used only for a single Kafka cluster.
A base (prefix) path can be specified in the Kafka configuration file, so that multiple Kafka clusters can use a single Zookeeper cluster. It can be added to the end of the Zookeeper connection string:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>zookeeper.connect=zoo1.my-domain.com:2181,zoo2.my-domain.com:2181,zoo3.my-domain.com:2181/my-cluster-1</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_listeners">3.2.2. Listeners</h4>
<div class="paragraph">
<p>Kafka brokers can be configured to use multiple listeners. Each listener can be used to listen on different port or
network interface and can have different configuration. Listeners are configured in the <code>listeners</code> property in the
configuration file. The <code>listeners</code> property contains a list of listeners with each listener configured as
<code>listenerName://hostname:port</code>. When the hostname value is empty, Kafka will use
<code>java.net.InetAddress.getCanonicalHostName()</code> as hostname. The following example shows how multiple listeners might be
configured:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>listeners=INT1://:9092,INT2://:9093,REPLICATION://:9094</code></pre>
</div>
</div>
<div class="paragraph">
<p>When a Kafka client wants to connect to a Kafka cluster, it first connects to a <em>bootstrap server</em>. The
<em>bootstrap server</em> is one of the cluster nodes. It will provide the client with a list of all other brokers which are part
of the cluster and the client will connect to them individually. By default the <em>bootstrap server</em> will provide the
client with a list of nodes based on the <code>listeners</code> field. However, in some situations it might be useful to give the client
a different set of addresss than given in the <code>listeners</code> property. Such situation might be, for example, when
additional network infrastructure, such as a proxy, is between the client and the broker, or when an external DNS name should
be used instead of an IP address. For these situations, the broker allows to define the advertised addresses of the
listeners in <code>advertised.listeners</code> configuration property. This property has the same format as the <code>listeners</code> property. The following
example shows how the advertised addresses might be configured. The names of the listeners have to match the names of the
listeners from the <code>listeners</code> property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>advertised.listeners=INT1://my-broker-1.my-domain.com:1234,INT2://my-broker-1.my-domain.com:1234:9093</code></pre>
</div>
</div>
<div class="paragraph">
<p>When the cluster has replicated topics, the brokers responsible for such topics  need to communicate with each other
in order to replicate the messages in these topics. When multiple listeners are configured, the configuration field
<code>inter.broker.listener.name</code> can be used to specify the name of the listener which should be used for this replication. For
example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>inter.broker.listener.name=REPLICATION</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_kafka_commit_logs">3.2.3. Kafka Commit Logs</h4>
<div class="paragraph">
<p>Apache Kafka stores all records it receives from producers in commit logs. Be aware that the commit logs
contain the actual data, in the form of records, that Kafka is there to deliver, and should not be
confused with application log files (which record whe the broker is doing). The commit logs are placed in one or more log
directories. Log directories are configured using property field <code>log.dirs</code>. It should be set to <code>/var/lib/zookeeper</code>
directory created during installation:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>log.dirs=/var/lib/zookeeper</code></pre>
</div>
</div>
<div class="paragraph">
<p>If required for performance reasons, <code>log.dirs</code> can point to multiple directories, each placed on a different physical
device to improve disk I/O performance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>log.dirs=/var/lib/zookeeper1,/var/lib/zookeeper2,/var/lib/zookeeper3</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_security_2">3.2.4. Security</h4>
<div class="paragraph">
<p>Kafka supports TLS for encrypting the communication with Kafka clients. Additionally, it supports two types of
authentication:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>TLS client authentication based on TLC client certificates</p>
</li>
<li>
<p>SASL Authentication based on username and password</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>SASL authentication is configured using Java Authentication and Authorization Service (JAAS). JAAS is also used for
authentication of connections between Kafka and Zookeeper. JAAS uses its own configuration file. The recommended location
for this file is <code>/opt/kafka/config/jaas.conf</code>. The file should be readable by the <code>kafka</code> user. When running Kafka,
the location of this file is specified using Java system property <code>java.security.auth.login.config</code>. This property has to be
passed to Kafka when starting the broker nodes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>KAFKA_OPTS="-Djava.security.auth.login.config=/path/to/my/jaas.config"; bin/kafka-server-start.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each listener in the Kafka broker is configured with its own security protocol. The configuration property <code>listener.security.protocol.map</code> defines which listener uses which security protocol.
It maps each listener name to its security protocol. Supported security protocols are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>PLAINTEXT</code></dt>
<dd>
<p>Listener without any encryption or authentication.</p>
</dd>
<dt class="hdlist1"><code>SSL</code></dt>
<dd>
<p>Listener using TLS encryption and, optionally, authentication using TLS client certificates.</p>
</dd>
<dt class="hdlist1"><code>SASL_PLAINTEXT</code></dt>
<dd>
<p>Listener without encryption but with SASL-based authentication.</p>
</dd>
<dt class="hdlist1"><code>SASL_SSL</code></dt>
<dd>
<p>Listener with TLS-based encryption and SASL-based authentication.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Given the following <code>listeners</code> configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>listeners=INT1://:9092,INT2://:9093,REPLICATION://:9094</code></pre>
</div>
</div>
<div class="paragraph">
<p>the <code>listener.security.protocol.map</code> might look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>listener.security.protocol.map=INT1:SASL_PLAINTEXT,INT2:SASL_SSL,REPLICATION:SSL</code></pre>
</div>
</div>
<div class="paragraph">
<p>This would configure the listener <code>INT1</code> to use unencrypted connections with SASL authentication, the listener <code>INT2</code>
to use encrypted connections with SASL authentication and the <code>REPLICATION</code> interface to use TLS encryption (possibly
with TLS client authentication). The same security protocol can be used multiple times. The following example is also
a valid configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>listener.security.protocol.map=INT1:SSL,INT2:SSL,REPLICATION:SSL</code></pre>
</div>
</div>
<div class="paragraph">
<p>Such a configuration would use TLS encryption and TLS authentication for all interfaces. The following chapters will
explain in more detail how to configure TLS and SASL.</p>
</div>
<div class="sect4">
<h5 id="_tls_encryption_and_authentication">TLS encryption and authentication</h5>
<div class="paragraph">
<p>In order to use TLS encryption and server authentication, a keystore containing private and public keys has to be provided. This is usually done
using a file in the Java Keystore (JKS) format. A path to this file is set in the <code>ssl.keystore.location</code> property. The
<code>ssl.keystore.password</code> property should be used to set the password protecting the keystore. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ssl.keystore.location=/path/to/keystore/server-1.jks
ssl.keystore.password=123456</code></pre>
</div>
</div>
<div class="paragraph">
<p>In some cases, an additional password is used to protect the private key. Any such password can be set using the
<code>ssl.key.password</code> property.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Kafka is able use keys signed by certification authorities as well as self-signed keys. Using keys signed by
certification authorities should always be the preferred method. In order to allow clients to verify the identity of the
Kafka broker they are connecting to, the certificate should always contain the advertised hostname(s) as its Common Name
(CN) or in the Subject Alternative Names (SAN).
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In addition to the keystore, a truststore with public keys can be provided to the broker. These keys can be used to
authenticate clients connecting to the broker. The truststore should be provided in Java Keystore (JKS) format and
should contain public keys of the certification authorities. All clients with public and private keys signed by one of
the certification authorities included in the truststore will be able to pass the authentication. The location of the
truststore is set using field <code>ssl.truststore.location</code>. In case the truststore is password protected, the password
should be set in the <code>ssl.truststore.password</code> property. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>ssl.truststore.location=/path/to/keystore/server-1.jks
ssl.truststore.password=123456</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the truststore is configured, TLS client authentication has to be enabled using the <code>ssl.client.auth</code> property. This
property can be set to one of three different values:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>none</code></dt>
<dd>
<p>TLS client authentication is switched off. (Default value)</p>
</dd>
<dt class="hdlist1"><code>requested</code></dt>
<dd>
<p>TLS client authentication is optional. Clients will be asked to authenticate using TLS client certificate
but they can choose not to.</p>
</dd>
<dt class="hdlist1"><code>required</code></dt>
<dd>
<p>Clients are required to authenticate using TLS client certificate.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When a client authenticates using TLS client authentication, the authenticated principal name is the distinguished name
from the authenticated client certificate. When TLS client authentication is not used and SASL is disabled, the
principal name will be <code>ANONYMOUS</code>.</p>
</div>
<div class="paragraph">
<p>It is possible to use different SSL configurations for different listeners. All options starting with <code>ssl.</code> can be
prefixed with <code>listener.name.&lt;NameOfTheListener&gt;.</code>. This will override the default SSL configuration for that specific
listener. The following example shows how to use different SSL configurations for different listeners:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>listeners=INT1://:9092,INT2://:9093,REPLICATION://:9094
listener.security.protocol.map=INT1:SSL,INT2:SSL,REPLICATION:SSL

# Default configuration - will be used for listeners INT1 and INT2
ssl.keystore.location=/path/to/keystore/server-1.jks
ssl.keystore.password=123456

# Different configuration for listener REPLICATION
listener.name.replication.ssl.keystore.location=/path/to/keystore/server-1.jks
listener.name.replication.ssl.keystore.password=123456
listener.name.replication.ssl.truststore.location=/path/to/keystore/server-1.jks
listener.name.replication.ssl.truststore.password=123456
listener.name.replication.ssl.client.auth=required</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to the main TLS configuration options described above, Kafka supports many options for fine-tuning the TLS
configuration. For example, to enable of disable TLS / SSL protocols or cipher suites.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ssl.cipher.suites</code></dt>
<dd>
<p>List of enabled cipher suites. Each cipher suite is a combination of authentication,
encryption, MAC and key exchange algorithms used for the TLC connection. By default, all available cipher suites are
enabled.</p>
</dd>
<dt class="hdlist1"><code>ssl.enabled.protocols</code></dt>
<dd>
<p>List of enabled TLS / SSL protocols. Defaults to <code>TLSv1.2,TLSv1.1,TLSv1</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A list of all available TLS configuration options can be found on the
<a href="http://kafka.apache.org/documentation/#configuration">Apache Kafka website</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kafka_authentication">Kafka authentication</h5>
<div class="paragraph">
<p>Kafka also supports authentication using the Simple Authentication and Security Layer (SASL).
SASL in Kafka is implemented using JAAS.
SASL authentication is supported both through plain unencrypted connections as well as through TLS connections. SASL can
be enabled individually for each listener. To enable it, the security protocol in <code>listener.security.protocol.map</code> has
to be either <code>SASL_PLAINTEXT</code> or <code>SASL_SSL</code>.</p>
</div>
<div class="paragraph">
<p>SASL authentication in Kafka supports three different mechanisms:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PLAIN</code> mechanism implements authentication based on username and passwords. Usernames and passwords are stored
locally in Kafka configuration.</p>
</li>
<li>
<p><code>SCRAM</code> mechanism implements authentication using Salted Challenge Response Authentication Mechanism. SCRAM
credentials are stored centrally in Zookeeper. SCRAM can be used in situations where Zookeeper cluster nodes are running
isolated in private network.</p>
</li>
<li>
<p><code>GSSAPI</code> mechanism implements authentication against a Kerberos server.</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The <code>PLAIN</code> mechanism sends the username and password in unencrypted format. It should be therefore used only in
combination with TLS encryption.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The SASL mechanisms are configured via the JAAS configuration file. Kafka uses the JAAS context named <code>KafkaServer</code>.
After they are configured in JAAS, the SASL mechanisms have to be enabled in the Kafka configuration. This is done using the
<code>sasl.enabled.mechanisms</code> property. This property contains a comma-separated list of enabled mechanisms:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sasl.enabled.mechanisms=PLAIN,SCRAM-SHA-256,SCRAM-SHA-512</code></pre>
</div>
</div>
<div class="paragraph">
<p>In case the listener used for inter-broker communication is using SASL, the property <code>sasl.mechanism.inter.broker.protocol</code>
has to be used to specify the SASL mechanism which it should use. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sasl.mechanism.inter.broker.protocol=PLAIN</code></pre>
</div>
</div>
<div class="paragraph">
<p>The username and password which will be used for the inter-broker communication has to be specified in the <code>KafkaServer</code>
JAAS context using the field <code>username</code> and <code>password</code>.</p>
</div>
<div class="paragraph">
<p>To use the PLAIN mechanism, the usernames and password which are allowed to connect are specified directly in the JAAS
context. The following example shows the context configured for SASL PLAIN authentication. The example configures three
different users:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>admin</code></p>
</li>
<li>
<p><code>user1</code></p>
</li>
<li>
<p><code>user2</code></p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>KafkaServer {
    org.apache.kafka.common.security.plain.PlainLoginModule required
    user_admin="123456"
    user_user1="123456"
    user_user2="123456";
};</code></pre>
</div>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
To avoid authentication problems, the credentials should be kept in sync between different Kafka brokers.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When SASL PLAIN is also used for inter-broker authentication, the <code>username</code> and <code>password</code> properties should
be included in the JAAS context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>KafkaServer {
    org.apache.kafka.common.security.plain.PlainLoginModule required
    username="admin"
    password="123456"
    user_admin="123456"
    user_user1="123456"
    user_user2="123456";
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>SCRAM authentication in Kafka consists of two mechanisms: <code>SCRAM-SHA-256</code> and <code>SCRAM-SHA-512</code>. These mechanism differ
only in the hashing algorithm used - SHA-256 versus stronger SHA-512. To enable SCRAM authentication, the JAAS configuration file
has to include the following configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>KafkaServer {
    org.apache.kafka.common.security.scram.ScramLoginModule required;
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>When enabling SASL authentication in the Kafka configuration file, both SCRAM mechanisms can be listed. However only one
of them can be chosen for the inter-broker communication. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sasl.enabled.mechanisms=SCRAM-SHA-256,SCRAM-SHA-512
sasl.mechanism.inter.broker.protocol=SCRAM-SHA-512</code></pre>
</div>
</div>
<div class="paragraph">
<p>User credentials for the SCRAM mechanism are stored in Zookeeper. Command line tool <code>kafka-configs.sh</code> can be used to
manage them. For example to add user <code>user1</code> with password <code>123456</code>, the following command can be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-configs.sh --zookeeper zoo1.my-domain.com:2181 --alter --add-config 'SCRAM-SHA-256=[password=123456],SCRAM-SHA-512=[password=123456]' --entity-type users --entity-name user1</code></pre>
</div>
</div>
<div class="paragraph">
<p>To delete a user credential use:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-configs.sh --zookeeper zoo1.my-domain.com:2181 --alter --delete-config 'SCRAM-SHA-512' --entity-type users --entity-name user1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The SASL mechanism used for authentication using Kerberos is called <code>GSSAPI</code>. To configure Kerberos SASL authentication,
the following configuration should be added to the JAAS configuration file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>KafkaServer {
    com.sun.security.auth.module.Krb5LoginModule required
    useKeyTab=true
    storeKey=true
    keyTab="/etc/security/keytabs/kafka_server.keytab"
    principal="kafka/kafka1.hostname.com@EXAMPLE.COM";
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to the JAAS configuration, the Kerberos service name needs to be specified in the
<code>sasl.kerberos.service.name</code> property in the Kafka configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>sasl.enabled.mechanisms=GSSAPI
sasl.mechanism.inter.broker.protocol=GSSAPI
sasl.kerberos.service.name=kafka</code></pre>
</div>
</div>
<div class="paragraph">
<p>Kafka can use multiple SASL mechanisms at the same time. The different JAAS configurations can be all added to the same context:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>KafkaServer {
    org.apache.kafka.common.security.plain.PlainLoginModule required
    user_admin="123456"
    user_user1="123456"
    user_user2="123456";

    com.sun.security.auth.module.Krb5LoginModule required
    useKeyTab=true
    storeKey=true
    keyTab="/etc/security/keytabs/kafka_server.keytab"
    principal="kafka/kafka1.hostname.com@EXAMPLE.COM";

    org.apache.kafka.common.security.scram.ScramLoginModule required;
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>When multiple mechanisms are enabled, clients will be able to choose the mechanism which they want to use.</p>
</div>
</div>
<div class="sect4">
<h5 id="_kafka_authorization">Kafka authorization</h5>
<div class="paragraph">
<p>The Kafka broker has out-of-the-box support for authorization. It is implemented using Access Control Lists (ACLs) - a set of rules
describing what uses can and cannot do. The ACL rules are stored in Zookeeper.</p>
</div>
<div class="paragraph">
<p>To enable Authorization / ACLs, the property <code>authorizer.class.name</code> has to be specified. It has to contain a fully
qualified name of the Authorizer class. For the built-in authorizer, the fully qualified name is <code>kafka.security.auth.SimpleAclAuthorizer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>authorizer.class.name=kafka.security.auth.SimpleAclAuthorizer</code></pre>
</div>
</div>
<div class="paragraph">
<p>The structure of ACL rules is: <em>Principal <code>P</code> is allowed / denied operation <code>O</code> on resource <code>R</code> from host
<code>H</code>.</em> When no rules are present for a given resource, all actions are denied. This behavior can be changed by setting the
property <code>allow.everyone.if.no.acl.found</code> to <code>true</code> in the Kafka configuration file.</p>
</div>
<div class="paragraph">
<p>A set of users can be defined as <em>super users</em>. Super users are allowed to take all actions regardless of the ACL
rules. Super users are defined in the Kafka configuration file using the property <code>super.users</code>. Users are defined using
their principals. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>super.users=User:admin,User:operator</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <em>principal</em> is the identity of the user and its exact format depends on the authentication mechanism:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clients which connected to Kafka without authentication will have principal <code>User:ANONYMOUS</code>.</p>
</li>
<li>
<p>Clients which connected using simple authentication mechanisms such as PLAIN or SCRAM will have principal consisting of
the string <code>User:</code> and their username. For example <code>User:admin</code> or <code>User:user1</code>.</p>
</li>
<li>
<p>Clients authenticated using TLS client authentication will have the principal based on the Distinguished Name of their
client certificate, prefixed with <code>User:</code>. For example <code>User:CN=user1,O=MyCompany,L=Prague,C=CZ</code>.</p>
</li>
<li>
<p>Clients authenticated using Kerberos by default will have a Kafka username that is the primary part of their Kerberos principal.
Property <code>sasl.kerberos.principal.to.local.rules</code> can be used to configure how the Kafka principal should be built from the
Kerberos principal.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Kafka ACLs can be applied to 3 different types of resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Topics</p>
</li>
<li>
<p>Consumer Groups</p>
</li>
<li>
<p>Cluster</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It supports several different operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Read</p>
</li>
<li>
<p>Write</p>
</li>
<li>
<p>Create</p>
</li>
<li>
<p>Delete</p>
</li>
<li>
<p>Alter</p>
</li>
<li>
<p>Describe</p>
</li>
<li>
<p>ClusterAction</p>
</li>
<li>
<p>All</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Not every operation can be applied to every resource. Following table shows which resources support which operations:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top">Topics</th>
<th class="tableblock halign-left valign-top">Consumer Groups</th>
<th class="tableblock halign-left valign-top">Cluster</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Write</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Create</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Delete</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Alter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Describe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ClusterAction</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Management of ACL rules is done using <code>kafka-acls.sh</code> utility which is part of the Kafka distribution package. It can
add, list and remove ACL rules. <code>kafka-acls.sh</code> contains three primary options for these functions:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Type</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--add</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add ACL rule</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--remove</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Remove ACL rile</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--list</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List ACL rules</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--authorizer-properties</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">key=val pairs that will be passed to authorizer for initialization. For the default authorizer the example values are:
<code>zookeeper.connect=zoo1.my-domain.com:2181</code>.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--cluster</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies cluster as an ACL resource.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--topic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies topic name as an ACL resource. <code>*</code> can be used as a wildcard which translates to "all topics". Multiple
<code>--topic</code> options can be specified in single command.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--group</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies consumer group name as an ACL resource. Multiple <code>--group</code> options can be specified in single command.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--allow-principal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Principal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Principal which will be added to an allow ACL rule. Multiple <code>--allow-principal</code> options can be specified in single
command.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--deny-principal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Principal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Principal which will be added to a deny ACL rule. Multiple <code>--deny-principal</code> options can be specified in single
command.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--allow-host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP address from which principals listed in <code>--allow-principal</code> will be allowed. <code>--deny-host</code> can be only specified as
IP address. Hostnames or CIDR ranges are not supported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If <code>--allow-principal</code> is specified defaults to <code>*</code> which translates to "all hosts".</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--deny-host</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IP address from which principals listed in <code>--deny-principal</code> will be denied. <code>--deny-host</code> can be only specified as IP
address. Hostnames or CIDR ranges are not supported.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">if <code>--deny-principal</code> is specified defaults to <code>*</code> which translates to "all hosts"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--operation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Operation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An operation which will be allowed or denied. Multiple <code>--operation</code> options can be specified in single command.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--producer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convenience</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A shortcut to allow or deny all operations needed by a message producer (WRITE and DESCRIBE on topic, CREATE
on cluster).</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--consumer</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convenience</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A shortcut to allow or deny all operations needed by a message consumer (READ and DESCRIBE on topic, READ on consumer
group)</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>--force</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convenience</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Assume yes to all queries and do not prompt.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following examples show how to use <code>kafka-acls.sh</code> to manage ACL rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding ACL rules</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># Allow user1 and user2 read from topic myTopic using consumer group MyConsumerGroup
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --add --operation Read --topic myTopic --allow-principal User:user1 --allow-principal User:user2
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --add --operation Describe --topic myTopic --allow-principal User:user1 --allow-principal User:user2
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --add --operation Read --operation Describe --group MyConsumerGroup --allow-principal User:user1 --allow-principal User:user2

# Deny user1 to read the topic from IP address 127.0.0.1
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --add --operation Describe --operation Read --topic myTopic --group MyConsumerGroup --deny-principal User:user1 --deny-host 127.0.0.1

# Add principal as consumer
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --add --consumer --topic myTopic --group MyConsumerGroup --allow-principal User:user1</code></pre>
</div>
</div>
</li>
<li>
<p>Removing ACL rules</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code># Remove principal as consumer
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --remove --consumer --topic myTopic --group MyConsumerGroup --allow-principal User:user1

# Deny user1 to read the topic from IP address 127.0.0.1
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --remove --operation Describe --operation Read --topic myTopic --group MyConsumerGroup --deny-principal User:user1 --deny-host 127.0.0.1

# Allow user1 and user2 read from topic myTopic using consumer group MyConsumerGroup
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --remove --operation Read --topic myTopic --allow-principal User:user1 --allow-principal User:user2
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --remove --operation Describe --topic myTopic --allow-principal User:user1 --allow-principal User:user2
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --remove --operation Read --operation Describe --group MyConsumerGroup --allow-principal User:user1 --allow-principal User:user2</code></pre>
</div>
</div>
</li>
<li>
<p>Listing ACL rules</p>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --list --topic myTopic
Current ACLs for resource `Topic:myTopic`:
        User:user1 has Allow permission for operations: Read from hosts: *
        User:user2 has Allow permission for operations: Read from hosts: *
        User:user2 has Deny permission for operations: Read from hosts: 127.0.0.1
        User:user1 has Allow permission for operations: Describe from hosts: *
        User:user2 has Allow permission for operations: Describe from hosts: *
        User:user2 has Deny permission for operations: Describe from hosts: 127.0.0.1</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To make sure topic replication works as expected, the Kafka broker nodes have to be allowed to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Allowed to do <code>ClusterAction</code> on cluster</p>
</li>
<li>
<p>Allowed to <code>Read</code> from all topics (<code>*</code>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To add such ACL rules, following ACL rules can be used (principal should be adapted according to the actual cluster
configuration):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --add --operation ClusterAction --cluster --allow-principal User:kafka
bin/kafka-acls.sh --authorizer-properties zookeeper.connect=zoo1.my-domain.com:2181 --add --operation Read --topic "*"</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_zookeeper_authentication">Zookeeper authentication</h5>
<div class="paragraph">
<p>Apache Zookeeper can be configured to use SASL-based authentication. SASL authentication for Zookeeper connections has
to be configured in the JAAS configuration file. By default, Kafka will use the JAAS context named <code>Client</code> for
connecting to Zookeeper. If needed, the context can be changed using the <code>zookeeper.sasl.clientconfig</code> system property.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The Apache Zookeeper section of this document describes in detail how to enable authentication in Zookeeper.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>Client</code> context should configure either the <code>PLAIN</code> SASL mechanism or Kerberos depending on the Zookeeper
configuration. The following example shows the configuration for SASL <code>PLAIN</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Client {
    org.apache.kafka.common.security.plain.PlainLoginModule required
    username="kafka"
    password="123456";
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Similarly it can be also configured to use Kerberos:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>Client {
       com.sun.security.auth.module.Krb5LoginModule required
       useKeyTab=true
       keyTab="/path/to/client/keytab"
       storeKey=true
       useTicketCache=false
       principal="yourzookeeperclient";
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>More information about JAAS configuration can be found in the
<a href="https://docs.oracle.com/javase/7/docs/jre/api/security/jaas/spec/com/sun/security/auth/module/Krb5LoginModule.html">JAAS documentation</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_zookeeper_authorization">Zookeeper authorization</h5>
<div class="paragraph">
<p>When authentication is enabled between Kafka and Zookeeper, Kafka can be configured to automatically protect all its
records with ACLs rules which will allow only the Kafka user to change the data. All other users will have read-only
access. ACL rules are controlled by the <code>zookeeper.set.acl</code> property and are disabled by default. To enabled the ACL
protection set <code>zookeeper.set.acl</code> to <code>true</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>zookeeper.set.acl=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>Kafka will set the ACL rules only for newly created Zookeeper nodes. When the ACLs are only enabled after the first
start of the cluster, the tool <code>zookeeper-security-migration.sh</code> has to be used to set ACLs on all existing nodes.
<code>zookeeper-security-migration.sh</code> is part of Kafka distribution and can be found in the <code>bin</code> directory. To set the
ACLs, run the following command (the Zookeeper URL and paths might need to be adapted):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - kafka
cd /opt/kafka
KAFKA_OPTS="-Djava.security.auth.login.config=./config/jaas.conf"; ./bin/zookeeper-security-migration.sh --zookeeper.acl=secure --zookeeper.connect=zoo1.my-domain.com:2181
exit</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more info about the <code>zookeeper-security-migration.sh</code> tool run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>/opt/kafka/bin/zookeeper-security-migration.sh --help</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Tha data stored in Zookeeper includes information such as topic names and their configuration. But it does not
include any records sent and received using Kafka. Kafka in general considers the data stored in Zookeeper as
non-confidential. In case these data are considered confidential (for example because topic names contain customer
identification) the only way how to protect them is by isolating Zookeeper on the network level and allowing
access only to Kafka brokers.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_topic_configuration">3.2.5. Topic configuration</h4>
<div class="paragraph">
<p>When a producer or consumer tries to send or receive messages to / from a topic which doesn&#8217;t exist, Kafka will, by default,
automatically create that topic. This behavior is controlled by the configuration property <code>auto.create.topics.enable</code>
which is set to <code>true</code> by default. To disable it, set <code>auto.create.topics.enable</code> to <code>false</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>auto.create.topics.enable=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Kafka also offers the possibility to disable deletion of topics. This is configured through the
<code>delete.topic.enable</code> property, which is set to <code>true</code> by default (i.e. deleting topics is possible). When this property is set to
<code>false</code> it will be not possible to delete topics and all attempts to delete topic will return success but the topic will
not be deleted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>delete.topic.enable=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>Auto-created topics will use the default topic configuration which can be specified in the broker properties file. However,
when creating topics manually, their configuration can be specified at creation time. The main topic configuration
options for manually created topics are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cleanup.policy</code></dt>
<dd>
<p>Configures the retention policy which can be <code>delete</code> or <code>compact</code>. The <code>delete</code> policy will delete
old records. The <code>compact</code> policy will enable log compaction. More information about log compaction can be found on
<a href="http://kafka.apache.org/documentation/#compaction">Kafka website</a>. The default value is <code>delete</code>.</p>
</dd>
<dt class="hdlist1"><code>compression.type</code></dt>
<dd>
<p>Specifies the compression which is used for stored messages. Valid values are <code>gzip</code>, <code>snappy</code>,
<code>lz4</code>, <code>uncompressed</code> (no compression) and <code>producer</code> (retain the compression codec used by the producer). The default value
is <code>producer</code>.</p>
</dd>
<dt class="hdlist1"><code>max.message.bytes</code></dt>
<dd>
<p>Maximum size of a batch of messages allowed by the Kafka broker, in bytes. The default value is <code>1000012</code>.</p>
</dd>
<dt class="hdlist1"><code>min.insync.replicas</code></dt>
<dd>
<p>The minimum number of replicas which must be in sync for a write to be considered successful.
The default value is <code>1</code>.</p>
</dd>
<dt class="hdlist1"><code>retention.ms</code></dt>
<dd>
<p>Maximum number of milliseconds for which log segments will be retained. Log segments older than this
value will be deleted. The default value is <code>604800000</code> (7 days).</p>
</dd>
<dt class="hdlist1"><code>retention.bytes</code></dt>
<dd>
<p>Maximum number of bytes a partition will retain. Once the partition size grows over this limit, the
oldest log segments will be deleted. Value of <code>-1</code> indicates no limit. The default value is <code>-1</code>.</p>
</dd>
<dt class="hdlist1"><code>segment.bytes</code></dt>
<dd>
<p>File size of a single commit log segment file in bytes. The default value is <code>1073741824</code> bytes (1 gibibyte).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Similar options are available to configure the default settings for auto-created topics:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>log.cleanup.policy</code></dt>
<dd>
<p>See <code>cleanup.policy</code> above.</p>
</dd>
<dt class="hdlist1"><code>compression.type</code></dt>
<dd>
<p>See <code>compression.type</code> above.</p>
</dd>
<dt class="hdlist1"><code>message.max.bytes</code></dt>
<dd>
<p>See <code>max.message.bytes</code> above.</p>
</dd>
<dt class="hdlist1"><code>min.insync.replicas</code></dt>
<dd>
<p>See <code>min.insync.replicas</code> above.</p>
</dd>
<dt class="hdlist1"><code>log.retention.ms</code></dt>
<dd>
<p>See <code>retention.ms</code> above.</p>
</dd>
<dt class="hdlist1"><code>log.retention.bytes</code></dt>
<dd>
<p>See <code>retention.bytes</code> above.</p>
</dd>
<dt class="hdlist1"><code>log.segment.bytes</code></dt>
<dd>
<p>See <code>segment.bytes</code> above.</p>
</dd>
<dt class="hdlist1"><code>default.replication.factor</code></dt>
<dd>
<p>Default replication factor for automatically created topics. Default value is <code>1</code>.</p>
</dd>
<dt class="hdlist1"><code>num.partitions</code></dt>
<dd>
<p>Default number of partitions for automatically created topics. Default value is <code>1</code>.</p>
</dd>
</dl>
</div>
<div class="sect4">
<h5 id="_topic_management">Topic management</h5>
<div class="paragraph">
<p>The <code>kafka-topics.sh</code> tool can be used to create, list and delete topics. <code>kafka-topics.sh</code> is part of Kafka distribution.
Following examples show how to create, list, describe and delete a topic:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Adding topics</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-topics.sh --zookeeper zoo1.my-domain.com:2181 --create --topic myTopic --partitions 50 --replication-factor 3 --config cleanup.policy=compact --config min.insync.replicas=2</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1">List topics</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-topics.sh --zookeeper zoo1.my-domain.com:2181 --list</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1">Describing topic</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-topics.sh --zookeeper zoo1.my-domain.com:2181 --describe --topic myTopic</code></pre>
</div>
</div>
</dd>
<dt class="hdlist1">Deleting topic</dt>
<dd>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-topics.sh --zookeeper zoo1.my-domain.com:2181 --delete --topic myTopic</code></pre>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Another tool, <code>kafka-configs.sh</code>, can be used to see the topic configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-configs.sh --zookeeper zoo1.my-domain.com:2181 --entity-type topics --entity-name myTopic --describe</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same tool can be used to change topic configuration as well:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-configs.sh --zookeeper zoo1.my-domain.com:2181 --entity-type topics --entity-name myTopic --alter --add-config min.insync.replicas=1</code></pre>
</div>
</div>
<div class="paragraph">
<p>It can also be used to remove a specific configuration value. Once the configuration override is removed, the default
value will be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>bin/kafka-configs.sh --zookeeper zoo1.my-domain.com:2181  --entity-type topics --entity-name myTopic --alter --delete-config min.insync.replicas</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_internal_topics">Internal topics</h5>
<div class="paragraph">
<p>Kafka has several internal topics. These are used to store consumer offsets (<code><em>consumer_offsets</code>) or transaction state
(<code></em>transaction_state</code>). These topics can be configured using dedicated options starting with prefix <code>offsets.topic.</code>
and <code>transaction.state.log.</code>. The most important configuration options are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>offsets.topic.replication.factor</code></dt>
<dd>
<p>Number of replicas for <code>__consumer_offsets</code> topic. The default value is <code>3</code>.</p>
</dd>
<dt class="hdlist1"><code>offsets.topic.num.partitions</code></dt>
<dd>
<p>Number of partitions for <code>__consumer_offsets</code> topic. The default value is <code>50</code>.</p>
</dd>
<dt class="hdlist1"><code>transaction.state.log.replication.factor</code></dt>
<dd>
<p>Number of replicas for <code>__transaction_state</code> topic. The default value is <code>3</code>.</p>
</dd>
<dt class="hdlist1"><code>transaction.state.log.num.partitions</code></dt>
<dd>
<p>Number of partitions for <code>__transaction_state</code> topic. The default value is <code>50</code>.</p>
</dd>
<dt class="hdlist1"><code>transaction.state.log.min.isr</code></dt>
<dd>
<p>Minimum number of replicas that must acknowledge a write to <code>__transaction_state</code> topic
to be considered successful. If this minimum cannot be met, then the producer will fail with an exception. The default value
is <code>2</code>.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_other_configuration_options">3.2.6. Other configuration options</h4>
<div class="paragraph">
<p>A list of all available configuration options can be found on the
<a href="http://kafka.apache.org/documentation/#configuration">Apache Kafka website</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_logging_2">3.2.7. Logging</h4>
<div class="paragraph">
<p>Kafka broker is using <em>log4j</em> as its logging infrastructure. Logging configuration is by default read from the
<code>log4j.propeties</code> configuration file which should be placed either in the <code>/opt/kafka/config/</code> directory or
in the classpath. The location and name of the configuration file can be changed using the Java property
<code>log4j.configuration</code> which can be passed to Zookeeper using the <code>KAFKA_LOG4J_OPTS</code> environment variable:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - kafka
export KAFKA_LOG4J_OPTS="-Dlog4j.configuration=file:/my/path/to/log4j.config"; /opt/kafka/bin/kafka-server-start.sh /opt/kafka/config/kafka.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>More information about <em>log4j</em> configuration can be found in the
<a href="http://logging.apache.org/log4j/1.2/manual.html"><em>log4j</em> manual</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_running_kafka">3.3. Running Kafka</h3>
<div class="paragraph">
<p>Kafka broker can be started using a script, <code>kafka-server-start.sh</code>, which is part of the Kafka broker distribution. This
script accepts the configuration file as parameter:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - kafka
/opt/kafka/bin/kafka-server-start.sh /opt/kafka/config/kafka.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default, <code>kafka-server-start.sh</code> starts Kafka in the foreground. Adding option <code>-daemon</code> will start Kafka as a background
process. When the <code>-daemon</code> option is used, it has to be placed as a first parameter right after the
<code>kafka-server-start.sh</code> script. Another option, <code>--override</code>, can be used to override properties in the configuration
file. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - kafka
/opt/kafka/bin/kafka-server-start.sh -daemon /opt/kafka/config/kafka.properties --override broker.id=1</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>KAFKA_OPTS</code> environment variable can be used to pass additional JVM options to Kafka. This is useful, for example, for
specifying the JAAS configuration file when SASL authentication is used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - kafka
export KAFKA_OPTS="-Djava.security.auth.login.config=/opt/kafka/config/jaas.config"; \
    /opt/kafka/bin/kafka-server-start.sh /opt/kafka/config/kafka.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>kafka-server-stop.sh</code> script can be used to stop all running Kafka brokers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>su - kafka
/opt/kafka/bin/kafka-server-stop.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p>This script will find the PIDs of all running Kafka brokers and stop them.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_apache_kafka_connect">4. Apache Kafka Connect</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO: Describe installation of standalone Kafka Connect and distributed Kafka connect cluster and the basic configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_apache_kafka_producer_and_consumer_apis">5. Apache Kafka Producer and Consumer APIs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kafka Producer and Consumer API are, together with Kafka AdminClient API, part of the <code>kafka-clients</code> package. The Producer API
allows applications to send data to a Kafka broker. The Consumer API allows applications to consume data from a Kafka broker.
The AdminClient API allows management of Kafka clusters (topics, brokers etc.).</p>
</div>
<div class="paragraph">
<p>The <code>kafka-clients</code> package is available in Maven. To use the APIs which are part of <code>kafka-clients</code>, following dependency should
be added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;
    &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_apache_kafka_streams_apis">6. Apache Kafka Streams APIs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Kafka Streams API allows applications to receive data from input streams and process them into output streams. It is
part of the <code>kafka-streams</code> package which is available in Maven. To use the Kafka Streams API the following dependency should be
added:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>&lt;dependency&gt;
    &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;
    &lt;artifactId&gt;kafka-streams&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sample_configuration_files">7. Sample configuration files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>TODO: Add sample configuration files for a Kafka cluster - perhaps something such as 3 node Zookeeper and 3 node Kafka.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2018-02-27 08:36:08 CET
</div>
</div>
</body>
</html>